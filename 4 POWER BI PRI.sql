USE HUBDADOS;

DECLARE @LISTA TABLE(IDCNT INT)

INSERT INTO @LISTA
VALUES ('21836'),
('20745'),
('90017950'),
('90032572'),
('90050493'),
('90055647'),
('90019992'),
('90032548'),
('90054446'),
('20934'),
('21808'),
('90019622'),
('90050448'),
('90066604'),
('90045538'),
('21020'),
('90021316'),
('90055386'),
('90057227'),
('90032552'),
('90018977'),
('90048967'),
('90065840'),
('21740'),
('90027193'),
('20804'),
('90019592'),
('90021179'),
('90067440'),
('21759'),
('90032544'),
('90056064'),
('90059526'),
('90055148'),
('90043251'),
('90032956'),
('90052289'),
('90014682'),
('90046946'),
('90062838'),
('21795'),
('90051447'),
('90033897'),
('90067171'),
('90033909'),
('90051450'),
('90067175'),
('90033916'),
('90051451'),
('90067176'),
('90045482'),
('90062585'),
('90062551'),
('90062248'),
('90067867'),
('90059388'),
('90059385'),
('90061842'),
('90061844'),
('90061845'),
('90061846'),
('90061850'),
('90061987'),
('90065876'),
('90068085'),
('90047183'),
('90045939'),
('90059390'),
('90066085'),
('90072692')
;

SELECT A.IDCNT AS 'ID CONTRATO'
	, D.IDMOV
	, E.NOMEFANTASIA AS 'COLIGADA'
	, A.NOME AS 'NOME CONTRATO'
	, A.CODIGOCONTRATO AS 'CONTRATO'
	, C.NOME AS 'CLIENTE/FORNECEDOR'
	, C.CGCCFO AS 'CNPJ'
	, F.NOME AS 'UNIDADE'
	, H.DATAVENCIMENTO AS 'VENCIMENTO'
	, H.DATABAIXA AS 'DATA PAGAMENTO/PREVISÃO'
	, SUBSTRING(D.NUMEROMOV, 2, LEN(D.NUMEROMOV)) AS 'N° NOTA'
	, D.DATAEMISSAO AS 'DATA DE EMISSÃO NF'
	, D.CODTMV AS 'MOVIMENTO DA NF'
	, FORMAT(D.VALORBRUTO, 'C', 'PT-BR') AS 'VALOR BRUTO'
	, FORMAT(D.VALORLIQUIDOORIG, 'C', 'PT-BR') AS 'VALOR LIQUIDO'
	, G.DESCRICAO AS 'STATUS'
	, D.DATACRIACAO AS 'DATA DA INCLUSÃO'
	, D.DATASAIDA AS 'DATA MODIFICAÇÃO'
	, I.NOME AS 'GESTOR'
	, J.NOME AS 'GERENTE'

FROM CorporeRM.TCNT A --CONTRATO
	INNER JOIN @LISTA B --LISTA
	ON A.IDCNT = B.IDCNT
	LEFT JOIN CorporeRM.FCFO C --FORNECEDOR
	ON A.CODCFO = C.CODCFO COLLATE Latin1_General_CI_AI
	LEFT JOIN CorporeRM.TMOV D --MOVIMENTO
	ON A.CODIGOCONTRATO = D.CAMPOLIVRE1 COLLATE Latin1_General_CI_AI
	LEFT JOIN CorporeRM.GCOLIGADA E --COLIGADA
	ON A.CODCOLIGADA = E.CODCOLIGADA
	LEFT JOIN CorporeRM.GDEPTO F --DEPARTAMENTO
	ON D.CODDEPARTAMENTO = F.CODDEPARTAMENTO COLLATE Latin1_General_CI_AI
	LEFT JOIN CorporeRM.TSTACNT G --STATUS
	ON A.CODSTACNT = G.CODSTACNT COLLATE Latin1_General_CI_AI
	LEFT JOIN CorporeRM.FLAN H --LANÇAMENTO
	ON D.IDMOV = H.IDMOV
	LEFT JOIN CorporeRM.TVEN I --GESTOR
	ON A.CODVEN = I.CODVEN COLLATE Latin1_General_CI_AI
	LEFT JOIN CorporeRM.TVEN J --GERENTE
	ON A.CODVEN2 = J.CODVEN COLLATE Latin1_General_CI_AI
WHERE D.CODTMV IN ('1.2.05', '1.2.14')
ORDER BY A.NOME ASC